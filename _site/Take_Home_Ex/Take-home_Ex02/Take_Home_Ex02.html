<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liu Jiaqi">

<title>ISSS608-VAA - Take-home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex01/Hands_on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex02/Hands_on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex03/Hands_on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex04/Hands_on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex05/Hands_on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex06/Hands_on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex07/Hands_on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex08/Hands_on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands_on_Ex09/Hands_on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex01/In_Class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex03/In_Class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex04/In_Class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Ex/In_Class_Ex05/In_Class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex01/Take_Home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex02/Take_Home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex03/Take_Home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#kickstarter" id="toc-kickstarter" class="nav-link active" data-scroll-target="#kickstarter">Kickstarter</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#extracting-the-nodes" id="toc-extracting-the-nodes" class="nav-link" data-scroll-target="#extracting-the-nodes">Extracting the nodes</a></li>
  <li><a href="#extracting-the-edges" id="toc-extracting-the-edges" class="nav-link" data-scroll-target="#extracting-the-edges">Extracting the edges</a></li>
  <li><a href="#preparing-edges-data-table" id="toc-preparing-edges-data-table" class="nav-link" data-scroll-target="#preparing-edges-data-table">Preparing edges data table</a></li>
  </ul></li>
  <li><a href="#preparing-nodes-data" id="toc-preparing-nodes-data" class="nav-link" data-scroll-target="#preparing-nodes-data">Preparing nodes data</a></li>
  <li><a href="#building-the-tidy-graph-data-model" id="toc-building-the-tidy-graph-data-model" class="nav-link" data-scroll-target="#building-the-tidy-graph-data-model">Building the tidy graph data model</a>
  <ul class="collapse">
  <li><a href="#visualising-the-network-graph-with-ggraph" id="toc-visualising-the-network-graph-with-ggraph" class="nav-link" data-scroll-target="#visualising-the-network-graph-with-ggraph">Visualising the network graph with ggraph</a></li>
  <li><a href="#exporting-data-objects" id="toc-exporting-data-objects" class="nav-link" data-scroll-target="#exporting-data-objects">Exporting data objects</a></li>
  </ul></li>
  <li><a href="#preparing-network-data-for-visnetwork" id="toc-preparing-network-data-for-visnetwork" class="nav-link" data-scroll-target="#preparing-network-data-for-visnetwork">Preparing Network Data for visNetwork</a>
  <ul class="collapse">
  <li><a href="#preparing-edges-tibble-data-frame" id="toc-preparing-edges-tibble-data-frame" class="nav-link" data-scroll-target="#preparing-edges-tibble-data-frame">Preparing edges tibble data frame</a></li>
  <li><a href="#preparing-nodes-tibble-data-frame" id="toc-preparing-nodes-tibble-data-frame" class="nav-link" data-scroll-target="#preparing-nodes-tibble-data-frame">Preparing nodes tibble data frame</a></li>
  <li><a href="#plotting-a-simple-interactive-network-graph" id="toc-plotting-a-simple-interactive-network-graph" class="nav-link" data-scroll-target="#plotting-a-simple-interactive-network-graph">Plotting a simple interactive network graph</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#take-home-exercise" id="toc-take-home-exercise" class="nav-link" data-scroll-target="#take-home-exercise">Take Home Exercise</a>
  <ul class="collapse">
  <li><a href="#preparing-edges-data-table-1" id="toc-preparing-edges-data-table-1" class="nav-link" data-scroll-target="#preparing-edges-data-table-1">Preparing edges data table</a></li>
  <li><a href="#preparing-nodes-data-table" id="toc-preparing-nodes-data-table" class="nav-link" data-scroll-target="#preparing-nodes-data-table">Preparing nodes data table</a></li>
  <li><a href="#building-the-tidy-graph-data-model-1" id="toc-building-the-tidy-graph-data-model-1" class="nav-link" data-scroll-target="#building-the-tidy-graph-data-model-1">Building the tidy graph data model</a></li>
  <li><a href="#visualising-the-network-graph-with-ggraph-1" id="toc-visualising-the-network-graph-with-ggraph-1" class="nav-link" data-scroll-target="#visualising-the-network-graph-with-ggraph-1">Visualising the network graph with ggraph</a></li>
  <li><a href="#visualising-the-network-graph-with-visnet" id="toc-visualising-the-network-graph-with-visnet" class="nav-link" data-scroll-target="#visualising-the-network-graph-with-visnet">Visualising the network graph with visNet</a></li>
  <li><a href="#visualising-network-metrics" id="toc-visualising-network-metrics" class="nav-link" data-scroll-target="#visualising-network-metrics">Visualising network metrics</a></li>
  <li><a href="#plotting-ego-network-of-the-identified-node" id="toc-plotting-ego-network-of-the-identified-node" class="nav-link" data-scroll-target="#plotting-ego-network-of-the-identified-node">Plotting Ego Network of the identified node</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liu Jiaqi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">28/5/2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="kickstarter" class="level1">
<h1>Kickstarter</h1>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>The code chunk below will be used to install and load the necessary R packages to meet the data preparation, data wrangling, data analysis and visualisation needs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, visNetwork, lubridate, tidyverse, ggiraph, patchwork, GGally, igraph, igraphdata, visNetwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import" class="level2">
<h2 class="anchored" data-anchor-id="data-import">Data Import</h2>
<p>In the code chunk below, <code>fromJSON()</code> of <strong>jsonlite</strong> package is used to import <em>mc2_challenge_graph.json</em> into R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc2_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="Callout-note">
<p>Examine the list object created by using RStudio, especially <em>nodes</em> and <em>links</em> data tables.</p>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data Wrangling</h2>
<section id="extracting-the-nodes" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-nodes">Extracting the nodes</h3>
<p>The code chunk is used to extract <em>nodes</em> data table from <em>mc2_data</em> list object and save the output in a tibble data frame object called <em>mc2_nodes</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, shpcountry, rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Thing to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>select()</code> is used not only to select the field needed but also to re-organise the sequent of the fields.</li>
</ul>
</div>
</div>
</section>
<section id="extracting-the-edges" class="level3">
<h3 class="anchored" data-anchor-id="extracting-the-edges">Extracting the edges</h3>
<p>The code chunk is used to extract <em>edgess</em> data table from <em>mc2_data</em> list object and save the output in a tibble data frame object called <em>mc2_edges</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ArrivalDate =</span> <span class="fu">ymd</span>(arrivaldate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(ArrivalDate)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, ArrivalDate, Year, hscode, valueofgoods_omu, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         volumeteu, weightkg, valueofgoodsusd) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>mutate()</code> is used two times to create two derive fields.
<ul>
<li><code>ymd()</code> of <strong>lubridate</strong> package is used to covert <em>arrivaldate</em> field from character data type into date data type.</li>
<li><code>year()</code> of <strong>lubridate</strong> package is used to convert the values in ArrivalDate field into year values.</li>
</ul></li>
<li><code>select()</code> is used not only to select the field needed but also to re-organise the sequent of the fields.</li>
</ul>
</div>
</div>
</section>
<section id="preparing-edges-data-table" class="level3">
<h3 class="anchored" data-anchor-id="preparing-edges-data-table">Preparing edges data table</h3>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn from the code chunk below
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>filter()</code> is used to select records whereby hscode is equal 306170 and Year is equal to 2028.</li>
<li><code>group_by()</code> is used to aggregate values by source, target, hscode, Year.</li>
<li><code>summarise()</code> and <code>n()</code> are used to count the aggregated records.</li>
<li>filter() is then used to perform two selections
<ul>
<li>to select all records whereby source are not equal to target, and</li>
<li>to select all records whereby the values of their weights field are greater than 20</li>
</ul></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"306170"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2028"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weights <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-nodes-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-nodes-data">Preparing nodes data</h2>
<p>Instead of using the nodes data table extracted from <em>mc2_data</em>, we will prepare a new nodes data table by using the source and target fields of <code>mc2_edges_aggregated</code> data table. This is necessary to ensure that the nodes in nodes data tables include all the source and target values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>mc2_nodes_extracted <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-the-tidy-graph-data-model" class="level2">
<h2 class="anchored" data-anchor-id="building-the-tidy-graph-data-model">Building the tidy graph data model</h2>
<p>The code chunk below is then used to build the tidy graph data model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_extracted,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc2_edges_aggregated,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualising-the-network-graph-with-ggraph" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-network-graph-with-ggraph">Visualising the network graph with ggraph</h3>
<p>In order to check if the tidygraph model has been prepared correctly, we can use selected functions of <strong>ggraph</strong> package to plot a simple network graph as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc2_graph,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_Home_Ex02_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exporting-data-objects" class="level3">
<h3 class="anchored" data-anchor-id="exporting-data-objects">Exporting data objects</h3>
<p>Code chunk below will be used to export the data objects prepared in previous section into rds format for subsequent use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_nodes_extracted, <span class="st">"data/mc2_nodes_extracted.rds"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_edges_aggregated, <span class="st">"data/mc2_edges_aggregated.rds"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_graph, <span class="st">"data/mc2_graph.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="preparing-network-data-for-visnetwork" class="level2">
<h2 class="anchored" data-anchor-id="preparing-network-data-for-visnetwork">Preparing Network Data for visNetwork</h2>
<p>Instead of plotting static network graph, we can plot interactive network graph by using visNetwork package. Before we can plot a interactive network graph by using visNetwork package, we are required to prepare two tibble data frames, one for the nodes and the other one for the edges.</p>
<section id="preparing-edges-tibble-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="preparing-edges-tibble-data-frame">Preparing edges tibble data frame</h3>
<p>In this example, we assume that you already have created a tidygraph model look similar to the print below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mc2_graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 123 nodes and 146 edges
#
# A directed acyclic simple graph with 12 components
#
# A tibble: 123 × 1
  id                                             
  &lt;chr&gt;                                          
1 1 Ltd. Liability Co Cargo                      
2 Adriatic Catch Ltd. Liability Co Transportation
3 Adriatic Tuna AS Solutions                     
4 Amerigo Dockyard S.p.A. Distribution           
5 Aqua Adventures Carriers Seabed                
6 Aqua Azul LC International                     
# ℹ 117 more rows
#
# A tibble: 146 × 5
   from    to hscode  Year weights
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;
1     1    74 306170  2028      68
2     2    75 306170  2028      30
3     3    76 306170  2028      22
# ℹ 143 more rows</code></pre>
</div>
</div>
<p>Note that tidygraph model is in R list format. The code chunk below will be used to extract and convert the edges into a tibble data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-node callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>activate()</code> is used to make the edges of mc2_graph1 active. This is necessary in order to extract the correct compontent from the list object.</li>
<li><code>as.tibble()</code> is used to convert the edges list into tibble data frame.</li>
</ul>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You might be curious to ask why don’t we used <em>mc2_edges</em>, the tibble data frame extracted in the earlier section. If you compare the data structure of both data frames, you will notice the first two field names in <em>edges_df</em> are called <em>from</em> and <em>to</em> instead of <em>source</em> and <em>target</em>. This is conformed to the nodes data structure of igraph object. Also note that the data type of <em>from</em> and <em>to</em> are in numeric data type and not in character data type.</p>
</div>
</div>
</section>
<section id="preparing-nodes-tibble-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="preparing-nodes-tibble-data-frame">Preparing nodes tibble data frame</h3>
<p>In this section, we will prepare a nodes tibble data frame by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nodes_df <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Things to learn from the code chunk above
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>activate()</code> is used to make the edges of mc2_graph1 active. This is necessary in order to extract the correct compontent from the list object.</li>
<li><code>as.tibble()</code> is used to convert the edges list into tibble data frame.</li>
<li><code>rename()</code> is used to rename the field name id to label.</li>
<li><code>mutate()</code> is used to create a new field called id and <code>row_number()</code> is used to assign the row number into id values.</li>
<li><code>select()</code> is used to re-organised the field name. This is because visNerwork is expecting the first field is called id and the second field is called label.</li>
</ul>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>visNetowrk is expecting a field called <em>id</em> in the tibble data frame. The field must be in numeric data type and it must unique to the values in the from and to field of edges_df.<br>
</li>
</ul>
</div>
</div>
</section>
<section id="plotting-a-simple-interactive-network-graph" class="level3">
<h3 class="anchored" data-anchor-id="plotting-a-simple-interactive-network-graph">Plotting a simple interactive network graph</h3>
<p>To ensure that the tibble data frames are confirmed to the requirements of visNetwork, we will plot a simple interactive graph by using the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>           edges_df) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"curvedCW"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0901dc67318dad073342" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0901dc67318dad073342">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123],"label":["1 Ltd. Liability Co Cargo","Adriatic Catch Ltd. Liability Co Transportation","Adriatic Tuna AS Solutions","Amerigo Dockyard S.p.A. Distribution","Aqua Adventures Carriers Seabed","Aqua Azul LC International","Arunachal Pradesh s Plc","Balkan Cat ОАО Transport","Bay of Bengal's Corp","Blue Horizon Family &","Chuan gou  N.V. Delivery","CoralCove Foods AG Marine conservation","Costa del Mar Ges.m.b.H. Marine biology","Costa del Viento A/S Freight ","Daniel Ferry N.V. Transit","Danish Plaice BV Investment","Danish Plaice Ltd. Liability Co Logistics","Donald Sp & Son's","Dutch Bill  Marine mist NV Freight ","Dutch Eel AB Holdings","Finests  Salmon Ltd Marine ecology","French  Seabed S.p.A. Forwading","Haryana s Plc Transit","Irish Scallop Corporation Transport","Italian Sardines Ltd. Liability Co","Lake Tana  & Son's","Ltd. Corporation Ltd. Liability Co","Manipur  Market Corporation Cargo","Mar de la Costa Sagl","Mar de la Felicidad BV","Mar de la Felicidad NV","Mar de la Vida S.p.A.","Mar del Oeste Cruise ship","Mar del Placer CJSC Transport","Marine Masterminds SE Saltwater","Michael Ltd. Corporation Seal","Neptune's Realm NV Navigation","Noord Limited Liability Company Line","Náutica del Sol Brothers","Ob River Ltd. Liability Co","Ocean Emporium Pic Holdings","Ocean Outfitters Ltd. Corporation","Oceanfront Oases Co Shipping","Oceanfront Oasis Company Green ","Perla del Mar BV","Perla del Mar Deep-sea","Playa de Arena OJSC Express","Playa del Mar Corporation","ReefRider Foods S.p.A. Cargo","Richard S.A. de C.V. Solutions","Rift Valley fishery Sagl","Rufiji River  Ges.m.b.H. Family","Saltwater Sirens Limited Liability Company Marine conservation","SeaBass  Ltd. Liability Co Consulting","Selous Game Reserve  AB","Spanish Shrimp A/S Marine","Surf and Sea Marine","Tamil Nadu s Barge","The Sea Lion Corporation","Tripura  Market S.A. de C.V.","Tristen Jetty Company Solutions","Turkish Sword NV Ocean","Uttar Pradesh Sea  A/S Express","Viento Azul N.V. Distribution","Viento y Mar BV","Wave Watchers Ltd. Liability Co","bǐ mù yú AG Marine","bǐ mù yú Sagl Distribution","guī yú Ltd. Corporation","qīng yú Ltd. Corporation","shí rén yú Marine conservation","suō yú GmbH & Co. KG Freight ","xiǎo lóng xiā SRL","Himachal Pradesh  BV Holdings","The Sea Turtle GmbH & Co. KG","AquaDelight N.V. Coral Reef","Caracola del Sol Services","Shou gan  Limited Liability Company Distribution","Caracola del Este Ltd. Liability Co","Casablanca Coast  Flounder Oyj Line","Lake Turkana  Charter Boat  NV Marine","Sea Breeze Corporation Marine sanctuary","-5669","-5670","Arunachal Pradesh s Brine","Costa de la Felicidad Shipping","Mar del Este CJSC","Dubingiai Ltd. Liability Co","Coastal Castaway Coast Corporation Worldwide","Madagascar Coast  AG Freight ","Mar del Paraíso Corporation Logistics","Selous Game Reserve  S.A. de C.V.","hǎi dǎn AG Express","hǎi dǎn Corporation Wharf","hǎi mǎ Sagl Express","SeaLion Marine AG Express","Punjab s Marine conservation","Pao gan SE Seal","Arena del Mar Marine Marine biology","Maharashtra  Ltd. Liability Co Shipping","Saltwater Supreme Pelican Ltd Enterprises","West Bengal   OJSC Transport","Tripura  Pier N.V. Solutions","Mar del Placer Manatee","3 Oceanography ОАО Marine life","Water Wonders AG Transport","Rybachit Sagl and Son's","-1363","Kilimanjaro fishery Ltd. Corporation Carriers","-1539","Coral Cove BV Delivery","Isla del Tesoro GmbH & Co. KG Chart","Pao gan LC Freight ","Brisa del Este BV","Playa de Arena SE Underwater","Yu xian  SRL Industrial","Black Sea Tuna Snapper","Mar de la Luz Plc","Assam  Market Cargo ship Company Marine conservation","Sailors and Surfers Incorporated Enterprises","-1203","Mar de Plata BV Marine","Selkie Ltd. Liability Co"],"x":[-0.727159654313757,0.578201644685885,-0.226749751058526,-0.984020698788553,-0.0538492880668293,0.163085076416623,-0.717382255773474,0.207246816309934,-0.379072415774633,0.298539950506773,-0.405024050798561,-0.0495686747375401,-0.468877988603469,0.209823937809525,-0.388692358300363,-0.457037657433187,0.222098329707804,0.118618185423833,-0.378282832808741,0.291915260313617,-0.455157485014464,-0.130559765569231,-0.249524051732204,-0.572845395915785,-0.486173128633895,0.0485651619363647,0.360605930243565,0.166814813868917,-0.322883087391926,0.781322729483611,-0.86839501964215,0.394079683981578,0.0419029061417409,0.134861160786382,0.0990905193726843,-0.147299120412273,0.477093991455571,0.311386399059335,-0.448299717550997,0.0528412270270171,0.213832829982946,0.391498566195235,0.691400160584702,0.745676721682643,-0.53271215094297,0.367207440293198,-0.162362162328744,0.573454902647082,-0.177558035983732,-0.458192022382263,-0.855236612466766,0.0297072973375601,0.228532431338113,-0.0495187311248291,-0.301376605989933,0.0596512695007652,-0.552514395744376,0.492519475094787,-0.908057022109225,0.162387491689005,0.30344247628134,0.64231878191085,0.643756099814321,-0.488911436277005,-0.0291757108769776,0.319790954673604,-0.0662666287469438,0.868448860243006,0.555250357391109,-0.868385883772661,0.724943197736197,0.983143346574602,-0.164616353945387,-0.655660357565065,0.441745664605248,-0.244866537793838,-0.0145136182237655,-1,-0.102405174754175,-0.173964394386825,0.176632273559856,0.00501330665760102,0.177558479723783,0.269020169571532,0.0218908770547541,0.0874198060764146,0.227145290728077,-0.580975645721925,0.390010753054933,0.324689941755645,0.266822755610331,0.56471535250666,0.500114305358619,0.086132212371548,0.308699972267616,-0.61045741835116,0.154068254017531,-0.339119934714816,0.4448258898035,0.137797424304849,-0.293320711978428,-0.239102179353186,-0.0918435619126732,0.466635991762764,-0.399425836144373,-0.845308445242103,0.560389106189735,0.227535091434177,-0.0327822922816129,0.539821623969893,0.811734340981862,-0.650614820240903,-0.159198596920256,0.464735162574313,0.780553199996848,-0.246579698833476,-0.740463692796041,-0.93532738884853,-0.568189349163677,0.601672227500974,0.8074471304456,-0.951980378141208,1],"y":[0.667879541619763,0.442235814572314,-0.224379474939902,0.0142028085996304,-0.546705437877525,-0.802961918355808,-0.598158395411824,-0.0315517701871278,0.114611966251016,-0.0259178313110844,-0.28432286761783,0.0817138579852017,0.0547031639628217,0.375903840331085,0.0222909106278646,0.473589100740559,-0.210843897269048,0.499560114733342,0.508574238592817,0.323109516160157,-0.482527474392587,0.0934525706086964,-0.645010932376991,0.793285534513664,-0.544796783749521,-0.18328516563902,-0.319823578372613,-0.503376913701882,0.959730883392955,-0.157212714744781,0.404297595117725,-0.651259657702141,-0.0301328511093941,0.405769598418401,0.331337813391331,-0.0916336771071904,0.852564591280975,0.929900733972752,-0.142185500029028,0.980786236361429,-0.686131833563081,-0.554358541382564,0.242293209067981,-0.0636906347146705,0.401729284055059,-0.0252331169880375,-0.313249992206276,-0.38055166048234,0.869977644622834,-0.0469196813332119,-0.127079069571491,0.417091150311844,-0.468516186779664,0.383987941353517,0.586356844406329,-0.383887087269497,-0.0757782945437641,0.50507203251532,-0.468935132663557,-0.288406621577718,-0.685964696986856,0.752533593833644,-0.408191676915965,-0.628075366154659,0.307501189448372,-0.503207460826577,-0.694539711361114,0.4981010019054,-0.251889066650753,0.205550150128119,-0.330141935958463,0.181231637462458,-0.541332240889146,0.728843717414988,0.304591845270812,-0.0768659147279165,-0.309997853675203,-0.0830604678010591,-0.196934429187411,-0.781450070225526,-0.566476168163287,-0.439447378394864,-0.990619243510746,-0.962095179661694,-0.94602338225343,-1,-0.431555750713402,-0.497817630835689,0.121259524885473,-0.248724366072368,-0.132009295119083,-0.180276005859158,0.130841128650069,0.157129134984561,0.171618613917225,-0.319014751188308,0.0717277763818085,0.324095187874267,-0.129221752659886,0.699387893885375,-0.41891942871406,0.264257820099604,-0.434318337675771,-0.566706743053061,0.911809510717455,0.492354182394465,0.805843332004079,0.957882771066627,1,-0.74701655263675,0.310330241645315,0.461475632759669,-0.452741842177677,-0.470069890944786,-0.463680501650469,0.757928836905129,-0.0824090994332398,-0.376528272169319,-0.78315610406409,-0.509154325746475,0.578996148892262,0.225771679153421,0.0807204733658757]},"edges":{"from":[1,2,3,3,4,5,5,5,5,6,6,6,6,6,6,7,8,8,8,8,8,8,8,8,8,9,10,10,10,10,11,11,11,11,12,12,12,13,14,15,16,17,17,17,17,18,18,19,20,20,21,22,22,22,23,24,25,25,26,26,26,26,26,27,28,28,28,29,30,31,32,32,33,33,33,34,35,36,36,36,36,36,36,37,38,39,40,41,42,42,42,43,43,44,45,45,46,46,47,47,47,47,48,48,48,49,50,51,52,53,53,54,55,55,56,56,56,56,56,56,57,57,58,59,60,60,60,61,62,63,63,64,64,64,65,66,66,66,67,68,69,70,71,71,72,73],"to":[74,75,76,77,78,79,80,81,82,83,84,85,86,81,87,88,76,79,89,90,91,92,93,94,95,76,90,87,75,94,76,79,88,96,76,97,94,76,94,76,98,99,81,87,94,100,94,98,75,94,101,79,102,94,103,74,88,101,76,90,87,103,94,92,77,104,82,105,92,106,87,104,77,97,94,94,94,76,77,98,101,82,94,107,108,76,109,87,110,81,90,111,93,92,112,98,90,97,76,77,113,82,114,90,115,116,76,117,94,114,77,94,98,116,27,90,87,113,101,103,76,117,75,118,77,87,91,87,107,104,92,119,88,101,94,87,120,82,82,121,90,122,120,92,123,77],"hscode":["306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170"],"Year":[2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028],"weights":[68,30,22,21,42,80,23,42,46,54,21,234,30,33,22,28,126,31,23,36,66,36,62,29,37,54,61,21,23,45,63,182,24,24,64,89,44,40,73,176,95,34,65,21,134,50,29,25,191,80,24,42,22,35,120,68,28,50,101,49,40,25,39,83,246,127,59,25,49,80,43,22,135,35,26,26,173,21,26,34,36,32,27,183,73,96,21,64,35,41,57,41,82,63,28,44,70,115,23,30,36,27,79,40,37,24,36,41,62,25,46,59,63,26,125,72,26,90,55,36,122,22,57,30,23,22,21,204,260,36,74,21,37,28,36,456,67,25,35,33,32,164,32,44,58,30]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"arrows":"to","smooth":{"enabled":true,"type":"curvedCW"}},"physics":{"stabilization":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="take-home-exercise" class="level1">
<h1>Take Home Exercise</h1>
<section id="preparing-edges-data-table-1" class="level3">
<h3 class="anchored" data-anchor-id="preparing-edges-data-table-1">Preparing edges data table</h3>
<p>Some research indicates that fish products should have hs code starting with ‘03’. However, there is no hs code starting with ‘03’ in the data provided. I see that there are data with hs code starting with ‘3’ and end with ‘0’, moving the 0 in front gives seemingly correct hs codes as I randomly checked a few. For this exercise, I will only extract rows with hs code starting with ‘3’ and end with ‘0’. Due to limited computing power, only those with weights &gt; 20 are selected.</p>
<p>Year is also added as an attribute without additional filtering to help with following temporal analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_aggregated <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">substr</span>(hscode, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="st">"3"</span> <span class="sc">&amp;</span> <span class="fu">substr</span>(hscode, <span class="dv">6</span>, <span class="dv">6</span>) <span class="sc">==</span> <span class="st">"0"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weights <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="preparing-nodes-data-table" class="level3">
<h3 class="anchored" data-anchor-id="preparing-nodes-data-table">Preparing nodes data table</h3>
<p>Add additional attribute on Year that first transaction occurred and Year that last transaction occurred.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">min_year =</span> <span class="fu">min</span>(Year), <span class="at">max_year =</span> <span class="fu">max</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, min_year, max_year) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">min_year =</span> <span class="fu">min</span>(Year), <span class="at">max_year =</span> <span class="fu">max</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target, min_year, max_year) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>mc2_nodes_extracted <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="building-the-tidy-graph-data-model-1" class="level3">
<h3 class="anchored" data-anchor-id="building-the-tidy-graph-data-model-1">Building the tidy graph data model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mc2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_extracted,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc2_edges_aggregated,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualising-the-network-graph-with-ggraph-1" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-network-graph-with-ggraph-1">Visualising the network graph with ggraph</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc2_graph,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weights, <span class="at">colour =</span> Year)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_Home_Ex02_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Can’t tell much from the static network. Try interactive.</p>
</section>
<section id="visualising-the-network-graph-with-visnet" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-network-graph-with-visnet">Visualising the network graph with visNet</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>merged_nodes_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(nodes_df, mc2_nodes_extracted, <span class="at">by.x =</span> <span class="st">"label"</span>, <span class="at">by.y =</span> <span class="st">"id"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, min_year, max_year)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>distinct_nodes_df <span class="ot">&lt;-</span> <span class="fu">distinct</span>(merged_nodes_df, id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>distinct_nodes_df <span class="ot">&lt;-</span> distinct_nodes_df <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> min_year) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> edges_df <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">value =</span> weights) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mc2_graph_3_vis_plot <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(<span class="at">nodes =</span> distinct_nodes_df,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">edges =</span> edges_df,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Interactive visNet (selection by Year of first shipment)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">physics =</span> <span class="cn">TRUE</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">size =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">color =</span> <span class="fu">list</span>(<span class="at">highlight =</span> <span class="st">"lightgray"</span>), <span class="at">arrows =</span> <span class="st">"to"</span>, </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">smooth =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">selectedBy =</span> <span class="st">"group"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">highlightNearest =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">degree =</span> <span class="dv">1</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">hover =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">labelOnly =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">values =</span> nodes_df<span class="sc">$</span>id)) <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1234</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>mc2_graph_3_vis_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6dda144b268288aa1a64" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6dda144b268288aa1a64">{"x":{"nodes":{"id":[121,108,110,83,84,1,105,2,3,4,5,6,76,99,85,7,119,8,9,67,68,117,10,114,79,77,80,11,89,111,12,86,13,14,15,16,17,18,88,19,20,21,22,69,93,94,95,23,74,24,112,25,109,26,81,27,90,100,28,29,30,31,118,32,122,87,33,91,34,104,35,36,39,37,38,40,41,42,43,44,113,98,45,46,47,115,48,97,70,49,50,51,52,107,120,53,101,82,54,96,123,55,92,71,78,56,72,57,58,59,75,60,103,61,62,63,64,65,106,66,102,73,116],"label":["-1203","-1363","-1539","-5669","-5670","1 Ltd. Liability Co Cargo","3 Oceanography ОАО Marine life","Adriatic Catch Ltd. Liability Co Transportation","Adriatic Tuna AS Solutions","Amerigo Dockyard S.p.A. Distribution","Aqua Adventures Carriers Seabed","Aqua Azul LC International","AquaDelight N.V. Coral Reef","Arena del Mar Marine Marine biology","Arunachal Pradesh s Brine","Arunachal Pradesh s Plc","Assam  Market Cargo ship Company Marine conservation","Balkan Cat ОАО Transport","Bay of Bengal's Corp","bǐ mù yú AG Marine","bǐ mù yú Sagl Distribution","Black Sea Tuna Snapper","Blue Horizon Family &","Brisa del Este BV","Caracola del Este Ltd. Liability Co","Caracola del Sol Services","Casablanca Coast  Flounder Oyj Line","Chuan gou  N.V. Delivery","Coastal Castaway Coast Corporation Worldwide","Coral Cove BV Delivery","CoralCove Foods AG Marine conservation","Costa de la Felicidad Shipping","Costa del Mar Ges.m.b.H. Marine biology","Costa del Viento A/S Freight ","Daniel Ferry N.V. Transit","Danish Plaice BV Investment","Danish Plaice Ltd. Liability Co Logistics","Donald Sp & Son's","Dubingiai Ltd. Liability Co","Dutch Bill  Marine mist NV Freight ","Dutch Eel AB Holdings","Finests  Salmon Ltd Marine ecology","French  Seabed S.p.A. Forwading","guī yú Ltd. Corporation","hǎi dǎn AG Express","hǎi dǎn Corporation Wharf","hǎi mǎ Sagl Express","Haryana s Plc Transit","Himachal Pradesh  BV Holdings","Irish Scallop Corporation Transport","Isla del Tesoro GmbH & Co. KG Chart","Italian Sardines Ltd. Liability Co","Kilimanjaro fishery Ltd. Corporation Carriers","Lake Tana  & Son's","Lake Turkana  Charter Boat  NV Marine","Ltd. Corporation Ltd. Liability Co","Madagascar Coast  AG Freight ","Maharashtra  Ltd. Liability Co Shipping","Manipur  Market Corporation Cargo","Mar de la Costa Sagl","Mar de la Felicidad BV","Mar de la Felicidad NV","Mar de la Luz Plc","Mar de la Vida S.p.A.","Mar de Plata BV Marine","Mar del Este CJSC","Mar del Oeste Cruise ship","Mar del Paraíso Corporation Logistics","Mar del Placer CJSC Transport","Mar del Placer Manatee","Marine Masterminds SE Saltwater","Michael Ltd. Corporation Seal","Náutica del Sol Brothers","Neptune's Realm NV Navigation","Noord Limited Liability Company Line","Ob River Ltd. Liability Co","Ocean Emporium Pic Holdings","Ocean Outfitters Ltd. Corporation","Oceanfront Oases Co Shipping","Oceanfront Oasis Company Green ","Pao gan LC Freight ","Pao gan SE Seal","Perla del Mar BV","Perla del Mar Deep-sea","Playa de Arena OJSC Express","Playa de Arena SE Underwater","Playa del Mar Corporation","Punjab s Marine conservation","qīng yú Ltd. Corporation","ReefRider Foods S.p.A. Cargo","Richard S.A. de C.V. Solutions","Rift Valley fishery Sagl","Rufiji River  Ges.m.b.H. Family","Rybachit Sagl and Son's","Sailors and Surfers Incorporated Enterprises","Saltwater Sirens Limited Liability Company Marine conservation","Saltwater Supreme Pelican Ltd Enterprises","Sea Breeze Corporation Marine sanctuary","SeaBass  Ltd. Liability Co Consulting","SeaLion Marine AG Express","Selkie Ltd. Liability Co","Selous Game Reserve  AB","Selous Game Reserve  S.A. de C.V.","shí rén yú Marine conservation","Shou gan  Limited Liability Company Distribution","Spanish Shrimp A/S Marine","suō yú GmbH & Co. KG Freight ","Surf and Sea Marine","Tamil Nadu s Barge","The Sea Lion Corporation","The Sea Turtle GmbH & Co. KG","Tripura  Market S.A. de C.V.","Tripura  Pier N.V. Solutions","Tristen Jetty Company Solutions","Turkish Sword NV Ocean","Uttar Pradesh Sea  A/S Express","Viento Azul N.V. Distribution","Viento y Mar BV","Water Wonders AG Transport","Wave Watchers Ltd. Liability Co","West Bengal   OJSC Transport","xiǎo lóng xiā SRL","Yu xian  SRL Industrial"],"group":[2028,null,null,null,null,2030,2033,2034,2032,null,null,2028,2028,2031,2028,null,null,2028,null,null,2028,null,2029,2028,2028,2028,2028,2028,null,2028,null,2028,2030,null,2028,2031,2028,null,2029,null,2028,null,2030,null,null,2028,null,2028,null,null,2032,null,null,2028,null,2028,2029,null,2028,2032,null,2029,null,2030,2028,2028,2028,2030,null,2028,2028,2031,2029,2028,null,null,2031,null,2032,null,2028,2028,null,2028,2029,null,2030,2028,2028,null,null,null,null,2028,2029,null,2031,2029,null,null,2032,null,2028,2033,null,2028,2031,2028,2029,null,2028,2032,2028,2028,2028,2029,null,null,2029,2028,null,null,2028],"max_year":[2029,null,null,null,null,2030,2034,2034,2033,null,null,2034,2034,2034,2034,null,null,2034,null,null,2034,null,2034,2030,2033,2034,2034,2034,null,2034,null,2034,2032,null,2034,2034,2034,null,2029,null,2034,null,2030,null,null,2034,null,2030,null,null,2032,null,null,2034,null,2029,2034,null,2034,2034,null,2029,null,2034,2028,2034,2034,2034,null,2034,2034,2032,2030,2032,null,null,2034,null,2033,null,2033,2034,null,2029,2034,null,2034,2034,2028,null,null,null,null,2032,2034,null,2031,2034,null,null,2034,null,2034,2033,null,2033,2033,2028,2030,null,2034,2033,2030,2033,2031,2029,null,null,2029,2034,null,null,2034],"x":[-0.247644510554307,-0.00136321949937634,-0.152308906409471,-0.377598938694384,-0.307013217773771,-0.614257717373802,-0.854142793212905,-0.216175008484982,0.222538332876701,0.826682211126372,0.159397260510403,-0.255122208431891,0.416742678497799,0.0651926348002789,-0.208644655750597,0.744834285020872,0.530780465117004,0.235397335038869,0.586967335844041,-0.0321270870170697,-0.166031792787457,0.91882012953193,-0.0654614489309138,-0.370027500250901,0.357942419658278,-0.0591628459504761,0.171530664142921,0.55695915742636,0.409229970889085,0.859968948469067,0.320007464976455,-0.450530879193285,0.60395889911279,0.236900091185257,0.631143821782513,-0.636817075200253,0.0456717497646901,0.410444247644902,0.610529320373976,-0.670585845476633,0.0357561491016256,0.316134961637169,0.445282147662869,-0.142222862862952,0.533017621344499,0.195056655294696,0.453894251560242,0.348973708498501,-0.703075034762743,-0.789094199116922,-0.853406440151454,0.479454351587726,-0.334152164636596,0.14481542870522,-0.0466379012974073,-0.164787131958569,-0.0239599972653598,0.52059228537333,-0.239079224167714,-0.900673003535509,-0.409626155123486,0.413955926694686,0.53992456870598,-0.395359664661744,-0.496740954277275,-0.156039778480585,0.0640503238872905,0.0940360327441441,0.338918087874145,-0.456531998760503,0.372300544415284,0.0334218480489048,0.61285884519956,-0.927317088093329,0.00221695893822793,-0.402174759553115,-0.369986474323285,-0.0937290929202912,0.731172831050533,-0.444880823568716,0.164659054100486,-0.478999116618531,-0.717898802335288,8.41287421726733e-06,0.157794244104507,-0.361538719670615,-0.236220993764754,0.153059011887325,-0.564571857564501,-1,0.63832309539995,1,0.270213385185675,-0.862288066831072,-0.508362601907678,-0.263953759694385,0.269242532260609,-0.0406425104770369,0.183272356472345,0.753278880648689,0.183688694583998,-0.740189999103689,-0.226154992028056,-0.440190248936832,0.765395027055133,0.0536256155138926,0.193590105882597,0.739804429068369,-0.112950786446711,0.62494224109027,-0.114734003615905,-0.070311754956369,0.246437301830399,-0.301477096489095,-0.780062662610625,-0.429343264803455,0.473462016255865,0.137386438015118,0.350597294445516,-0.286003690830209,0.69402717799956,-0.274042948584804,-0.899782258184942],"y":[-0.979732121779075,-0.998960701218228,0.727754682226406,0.94049254116342,1,-0.626129690859666,0.60687496753857,-0.546852402673433,0.205486145688578,-0.553884709694724,0.659369899194531,0.802112559506801,0.233783430159067,0.608405102250357,0.998413599915093,0.749198806415682,0.944227951130208,0.0674613450979791,0.314583362865096,0.816927220378016,-0.949693883502679,0.104380733239264,0.00730050410693051,-0.231009094118059,0.3614845206883,0.183761395648998,0.903436856025286,0.472445355524729,-0.0996994903484304,-0.324428006022197,-0.0154910736358694,0.879277288591276,0.0720899035814455,-0.394301906675982,0.372589116377256,0.0245939096052059,0.351139305613241,-0.358322554176621,0.692122356004013,0.228706247323013,-0.327657900086971,0.846155952913485,0.108605832009637,-0.0863187592085302,-0.133757992359812,-0.0861340755334976,-0.0151125664085815,0.697311605788886,-0.624063020715457,-0.589778339125651,-0.0702316674972099,0.697139709336079,-0.819621843298761,0.246286531687335,0.647395709739439,0.295905341343543,0.115040431211473,-0.519737787547348,0.390520740997021,0.513971565063651,-0.0752569461714494,-0.926202164655344,-0.800096343707477,0.494344504056995,-0.887329881394894,0.440472602495297,-0.0411634455223002,0.133897294977681,-0.313020816486747,0.390905233765645,-0.228186611366457,0.261407504391768,0.159220257762601,-0.287942438358592,-0.900722888980012,-0.755018347999881,0.608412709463333,0.480294828484662,-0.258186523191045,0.0062727064602166,0.544305438587621,0.147872304450851,0.0120816737789056,-0.134883072457126,0.376235318319478,-0.375673132929658,-0.181667535202369,-0.158955458281235,-0.816607833392785,0.153762006314796,0.250152995325855,0.00178735205159875,-0.312037500495861,-0.364739929441168,0.504195555007598,-0.0475122820045021,0.603921581474614,0.544701743456824,-0.308543871038415,0.530612089416904,-0.905670379668793,0.163150878301961,0.104097824210239,0.294081402926032,-0.630656552593133,0.428908127001386,-1,0.188394042935661,-0.582564896956865,-0.773830632441957,-0.36235008794404,0.284130343194878,0.490719533988073,0.664212027819997,-0.411529920744823,0.206728430854444,0.792558578490925,-0.373589804354507,-0.864318131794354,0.55366624868047,0.106311180765562,0.172888852576019,0.172633418232738]},"edges":{"from":[1,2,3,3,4,5,5,5,5,6,6,6,6,6,6,7,8,8,8,8,8,8,8,8,8,9,10,10,10,10,11,11,11,11,12,12,12,13,14,15,16,17,17,17,17,18,18,19,20,20,21,22,22,22,23,24,25,25,26,26,26,26,26,27,28,28,28,29,30,31,32,32,33,33,33,34,35,36,36,36,36,36,36,37,38,39,40,41,42,42,42,43,43,44,45,45,46,46,47,47,47,47,48,48,48,49,50,51,52,53,53,54,55,55,56,56,56,56,56,56,57,57,58,59,60,60,60,61,62,63,63,64,64,64,65,66,66,66,67,68,69,70,71,71,72,73],"to":[74,75,76,77,78,79,80,81,82,83,84,85,86,81,87,88,76,79,89,90,91,92,93,94,95,76,90,87,75,94,76,79,88,96,76,97,94,76,94,76,98,99,81,87,94,100,94,98,75,94,101,79,102,94,103,74,88,101,76,90,87,103,94,92,77,104,82,105,92,106,87,104,77,97,94,94,94,76,77,98,101,82,94,107,108,76,109,87,110,81,90,111,93,92,112,98,90,97,76,77,113,82,114,90,115,116,76,117,94,114,77,94,98,116,27,90,87,113,101,103,76,117,75,118,77,87,91,87,107,104,92,119,88,101,94,87,120,82,82,121,90,122,120,92,123,77],"hscode":["306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170","306170"],"Year":[2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028,2028],"value":[68,30,22,21,42,80,23,42,46,54,21,234,30,33,22,28,126,31,23,36,66,36,62,29,37,54,61,21,23,45,63,182,24,24,64,89,44,40,73,176,95,34,65,21,134,50,29,25,191,80,24,42,22,35,120,68,28,50,101,49,40,25,39,83,246,127,59,25,49,80,43,22,135,35,26,26,173,21,26,34,36,32,27,183,73,96,21,64,35,41,57,41,82,63,28,44,70,115,23,30,36,27,79,40,37,24,36,41,62,25,46,59,63,26,125,72,26,90,55,36,122,22,57,30,23,22,21,204,260,36,74,21,37,28,36,456,67,25,35,33,32,164,32,44,58,30]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":true,"size":10},"manipulation":{"enabled":false},"edges":{"arrows":"to","color":{"highlight":"lightgray"},"smooth":{"enabled":true}},"physics":{"stabilization":false},"interaction":{"hover":true,"zoomSpeed":1},"layout":{"randomSeed":1234}},"groups":["2028",null,"2030","2033","2034","2032","2031","2029"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id","values":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123]},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":[2028,2029,2030,2031,2032,2033,2034]},"main":{"text":"Interactive visNet (selection by Year of first shipment)","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.1,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>To plot network metrics to explore further.</p>
</section>
<section id="visualising-network-metrics" class="level3">
<h3 class="anchored" data-anchor-id="visualising-network-metrics">Visualising network metrics</h3>
<p>Betweenness centrality with each</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">123</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> mc2_graph <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weights), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> min_year, </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="fu">centrality_betweenness</span>()))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_Home_Ex02_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The two nodes with the highest betweenness centrality seem odd they are not at the center of the network, linked with as many nodes nor have many shipments with other nodes. Use the following code chunk to identify the two nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>distinct_Source<span class="ot">&lt;-</span>mc2_edges_aggregated<span class="sc">%&gt;%</span><span class="fu">distinct</span>(source)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>distinct_Target<span class="ot">&lt;-</span>mc2_edges_aggregated<span class="sc">%&gt;%</span><span class="fu">distinct</span>(target)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>nodes_updated_source<span class="ot">&lt;-</span><span class="fu">semi_join</span>(mc2_nodes_extracted,distinct_Source,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by=</span><span class="fu">c</span>(<span class="st">"id"</span><span class="ot">=</span><span class="st">"source"</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>nodes_updated_target<span class="ot">&lt;-</span><span class="fu">semi_join</span>(mc2_nodes_extracted,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                                          distinct_Target,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by=</span><span class="fu">c</span>(<span class="st">"id"</span><span class="ot">=</span><span class="st">"target"</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>nodes_updated<span class="ot">=</span><span class="fu">bind_rows</span>(nodes_updated_source, nodes_updated_target)<span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id,<span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mc2_graph_2<span class="ot">&lt;-</span>igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>(mc2_edges_aggregated, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">vertices =</span> nodes_updated) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">as_tbl_graph</span>()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>mc2_graph_2<span class="ot">&lt;-</span>mc2_graph_2<span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness=</span><span class="fu">centrality_betweenness</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mc2_graph_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mc2_graph_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the top 2 nodes with the highest values in betweenness centrality</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>top_2 <span class="ot">&lt;-</span> mc2_graph_df <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">2</span>, betweenness)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Output the top 2 rows</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>top_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      name min_year max_year betweenness
1         Isla del Este SE     2028     2032          15
2 Selkie Ltd. Liability Co     2032     2034           3</code></pre>
</div>
</div>
<p>The two nodes are identified to be Isla del Este SE and Selkie Ltd.&nbsp;Liability Co.&nbsp;It’s rather interesting that the last shipment of Isla del Este SE was in 2032 and Selkie’s first shipment was in 2032 as well. This fits the modes operanti that FishEye mentioned whereas a company with illegal activities may close down and go active again under a new name.</p>
</section>
<section id="plotting-ego-network-of-the-identified-node" class="level3">
<h3 class="anchored" data-anchor-id="plotting-ego-network-of-the-identified-node">Plotting Ego Network of the identified node</h3>
<section id="isla-del-este-se" class="level4">
<h4 class="anchored" data-anchor-id="isla-del-este-se">Isla del Este SE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mc2_edges_ego1 <span class="ot">&lt;-</span> mc2_edges_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span> <span class="st">"Isla del Este SE"</span> <span class="sc">|</span> target <span class="sc">==</span> <span class="st">"Isla del Este SE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>id1_ego1 <span class="ot">&lt;-</span> mc2_edges_ego1 <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>id2_ego1 <span class="ot">&lt;-</span> mc2_edges_ego1 <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>mc2_nodes_ego1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1_ego1, id2_ego1) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mc2_graph_ego1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> mc2_nodes_ego1,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> mc2_edges_ego1,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc2_graph_ego1,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weights, <span class="at">colour =</span> Year), <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">'mm'</span>))) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>()) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> mc2_nodes_ego1<span class="sc">$</span>id), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take_Home_Ex02_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at the ego network, looks like that Isla del Este is under the mode of operation where it imports a large amount from a few companies and distribute the imported goods to other companies. Could be suspicous for transshipment.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>